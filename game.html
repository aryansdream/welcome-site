<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>

<title>Dodge The Blocks+</title>

<style>

/* ================= MODERN CLEAN UI ================= */

body{
  margin:0;
  background:#e8e6e1;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  font-family:system-ui,-apple-system,sans-serif;
  overflow:hidden;
}

.game-box{
  background:#ffffff;
  padding:22px;
  border-radius:22px;
  box-shadow:0 15px 40px rgba(0,0,0,.12);
  text-align:center;
  max-width:95vw;
}

canvas{
  background:#fafafa;
  border-radius:14px;
  box-shadow:0 6px 20px rgba(0,0,0,.08);
  width:90vw;
  max-width:400px;
  height:70vh;
  max-height:500px;
}

.info{
  margin-top:8px;
  font-size:14px;
  color:#666;
}

.btn{
  margin-top:10px;
  padding:8px 18px;
  background:#ff7a18;
  color:white;
  border:none;
  border-radius:18px;
  cursor:pointer;
}

/* controls */

.controls{
  margin-top:14px;
  display:flex;
  justify-content:center;
  gap:25px;
}

.ctrl-btn{
  width:65px;
  height:65px;
  font-size:26px;
  background:#ff7a18;
  color:white;
  border:none;
  border-radius:18px;
  box-shadow:0 6px 16px rgba(255,122,24,.3);
}

.ctrl-btn:active{
  transform:scale(.95);
}

@media(min-width:900px){
  .controls{ display:none; }
}

</style>
</head>

<body>

<div class="game-box">

  <h2>üéÆ Dodge + Coins</h2>

  <canvas id="game" width="400" height="500"></canvas>

  <div class="info">
    Score: <span id="score">0</span> |
    ‚ù§Ô∏è <span id="lives">3</span>
  </div>

  <button class="btn" onclick="restart()">Restart</button>

  <div class="controls">
    <button class="ctrl-btn" id="leftBtn">‚Üê</button>
    <button class="ctrl-btn" id="rightBtn">‚Üí</button>
  </div>

</div>

<script>

/* ================= SIMPLE SOUNDS ================= */

const audioCtx = new (window.AudioContext||window.webkitAudioContext)();

function beep(f,d){
  const o=audioCtx.createOscillator();
  const g=audioCtx.createGain();
  o.frequency.value=f;
  o.connect(g); g.connect(audioCtx.destination);
  o.start();
  g.gain.setValueAtTime(.2,audioCtx.currentTime);
  g.gain.exponentialRampToValueAtTime(.001,audioCtx.currentTime+d);
  o.stop(audioCtx.currentTime+d);
}

const sMove=()=>beep(600,.03);
const sCoin=()=>beep(900,.06);
const sHit=()=>beep(120,.4);
const sStart=()=>beep(500,.1);


/* ================= GAME ================= */

const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let player, blocks, coins, score, speed, running, lives;

let moveLeftHold=false;
let moveRightHold=false;

function init(){
  player={x:180,y:460,w:40,h:40};
  blocks=[];
  coins=[];
  score=0;
  speed=2.2;
  lives=3;
  running=true;
  sStart();
}

function rect(o,c){
  ctx.fillStyle=c;
  ctx.fillRect(o.x,o.y,o.w,o.h);
}

/* ===== spawn settings ===== */

const blockRate=0.02;
const coinRate=0.012;
const maxBlocks=7;

function spawnBlock(){
  if(blocks.length>=maxBlocks) return;

  const s=25+Math.random()*25;
  blocks.push({
    x:Math.random()*(canvas.width-s),
    y:-s,w:s,h:s
  });
}

function spawnCoin(){
  coins.push({
    x:Math.random()*(canvas.width-15),
    y:-15,w:15,h:15
  });
}

/* ===== collision ===== */

function hit(a,b){
  return a.x<b.x+b.w &&
         a.x+a.w>b.x &&
         a.y<b.y+b.h &&
         a.y+a.h>b.y;
}

/* ===== update ===== */

function update(){
  if(!running) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  /* smooth movement */
  if(moveLeftHold) player.x-=5;
  if(moveRightHold) player.x+=5;

  player.x=Math.max(0,Math.min(canvas.width-player.w,player.x));

  rect(player,"#ff7a18");

  /* blocks */
  blocks.forEach(b=>{
    b.y+=speed;
    rect(b,"#333");

    if(hit(player,b)){
      lives--;
      sHit();
      b.y=9999;

      if(lives<=0){
        running=false;
        setTimeout(()=>alert("Game Over! Score: "+score),100);
      }
    }
  });

  /* coins */
  coins.forEach(c=>{
    c.y+=speed;
    ctx.fillStyle="#f5b301";
    ctx.beginPath();
    ctx.arc(c.x+7,c.y+7,7,0,6.28);
    ctx.fill();

    if(hit(player,c)){
      score+=10;
      sCoin();
      c.y=9999;
    }
  });

  blocks=blocks.filter(b=>b.y<canvas.height+50);
  coins=coins.filter(c=>c.y<canvas.height+50);

  score++;
  speed+=0.0008; /* gradual harder */

  document.getElementById("score").innerText=score;
  document.getElementById("lives").innerText=lives;

  if(Math.random()<blockRate) spawnBlock();
  if(Math.random()<coinRate) spawnCoin();

  requestAnimationFrame(update);
}


/* ================= CONTROLS ================= */

/* keyboard hold */
document.addEventListener("keydown",e=>{
  if(e.key==="ArrowLeft"){moveLeftHold=true;sMove();}
  if(e.key==="ArrowRight"){moveRightHold=true;sMove();}
});

document.addEventListener("keyup",e=>{
  if(e.key==="ArrowLeft") moveLeftHold=false;
  if(e.key==="ArrowRight") moveRightHold=false;
});

/* mobile hold */
leftBtn.ontouchstart=()=>{moveLeftHold=true;sMove();}
rightBtn.ontouchstart=()=>{moveRightHold=true;sMove();}
leftBtn.ontouchend=()=>moveLeftHold=false;
rightBtn.ontouchend=()=>moveRightHold=false;


/* restart */

function restart(){
  init();
  update();
}

init();
update();

</script>

</body>
</html>
